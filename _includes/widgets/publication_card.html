{% assign publications = include.publications %}
<div class="row mt-4">
    <div class="col">
        <div class="card border-0 shadow-sm bg-white">
            <div class="card-body">
                <h4 class="card-title">
                    {% if include.title %}{{ include.title }}{% else %}<i class="fas fa-book"></i> Publications{% endif %}
                </h4>
                {% for item in publications limit:include.limit %}
                    <div class="row mb-4 border-bottom pb-3">
                        {% if item.cover %}
                        <div class="col-md-3">
                            <img src="{{ item.cover | relative_url }}" alt="{{ item.title }}" class="img-fluid rounded">
                        </div>
                        <div class="col-md-9">
                        {% else %}
                        <div class="col-md-12">
                        {% endif %}
                            <h5 class="mb-1">
                                {{ item.title }}
                                {% if item.pinned %}
                                <span class="badge badge-warning ml-2">Pinned</span>
                                {% endif %}
                                {% if item.selected %}
                                <span class="badge badge-success ml-2">Featured</span>
                                {% endif %}
                                {% if item.oral %}
                                <span class="badge badge-info ml-2">Oral</span>
                                {% elsif item.spotlight %}
                                <span class="badge badge-primary ml-2">Spotlight</span>
                                {% elsif item.poster %}
                                <span class="badge badge-secondary ml-2">Poster</span>
                                {% endif %}
                            </h5>
                            <p class="mb-1 small">{% include widgets/author_list.html authors=item.authors %}</p>
                            <p class="mb-1 small"><i>{{ item.pub }}</i>. {{ item.pub_date }}</p>
                            <p class="mb-2 small text-muted">{{ item.abstract }}</p>
                            
                            <p class="small mb-0">
                                {% for link in item.links %}
                                {% if link[1].url %}
                                <a target="{{ link[1]['target'] }}" href="{{ link[1]['url'] }}" class="btn btn-sm btn-outline-primary mr-1">{{ link[0] }}</a>
                                {% else %}
                                <a target="_blank" href="{{ link[1] }}" class="btn btn-sm btn-outline-primary mr-1">{{ link[0] }}</a>
                                {% endif %}
                                {% endfor %}
                                
                                {% comment %} Check for slide and poster files based on publication filename {% endcomment %}
                                {% assign pub_filename = item.slug %}
                                {% assign slide_found = false %}
                                {% assign poster_found = false %}
                                
                                {% for static_file in site.static_files %}
                                    {% assign file_basename = static_file.basename %}
                                    {% if static_file.extname == '.pdf' %}
                                        {% if static_file.path contains '/publications/slides/' and file_basename == pub_filename %}
                                            {% assign slide_found = true %}
                                            {% assign slide_url = static_file.path %}
                                        {% endif %}
                                        {% if static_file.path contains '/publications/posters/' and file_basename == pub_filename %}
                                            {% assign poster_found = true %}
                                            {% assign poster_url = static_file.path %}
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                                
                                {% if slide_found %}
                                <a target="_blank" href="{{ slide_url | relative_url }}" class="btn btn-sm btn-outline-success mr-1">Slides</a>
                                {% endif %}
                                {% if poster_found %}
                                <a target="_blank" href="{{ poster_url | relative_url }}" class="btn btn-sm btn-outline-info mr-1">Poster</a>
                                {% endif %}
                            </p>
                        </div>
                    </div>
                {% endfor %}
                
                {% if include.show_all_link %}
                <div class="text-right">
                    <a href="{{ 'publications' | relative_url }}" class="btn btn-sm btn-primary">
                        All Publications <i class="fas fa-angle-double-right"></i>
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div> 